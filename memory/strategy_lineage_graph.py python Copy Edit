import networkx as nx

class StrategyLineageGraph:
    def __init__(self):
        self.graph = nx.DiGraph()

    def add_strategy(self, name, parent=None, score=0.0):
        self.graph.add_node(name, score=score)
        if parent:
            self.graph.add_edge(parent, name)

    def top_lineage(self):
        scores = nx.get_node_attributes(self.graph, "score")
        return sorted(scores.items(), key=lambda x: x[1], reverse=True)

    def visualize(self):
        import matplotlib.pyplot as plt
        nx.draw(self.graph, with_labels=True, node_color='skyblue', font_weight='bold')
        plt.show()