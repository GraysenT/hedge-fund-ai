APP="main:app"
HOST="0.0.0.0"
PORTS=(8000 8080 8500)
RELOAD="--reload"

echo "üîç Checking for occupied ports..."
for PORT in "${PORTS[@]}"; do
    PID=$(lsof -ti tcp:$PORT)
    if [ -n "$PID" ]; then
        echo "‚ö†Ô∏è  Port $PORT is in use by PID $PID. Killing..."
        kill -9 $PID
    fi
done

echo "‚úÖ Ports cleared. Trying to start server..."

for PORT in "${PORTS[@]}"; do
    echo "üöÄ Trying port $PORT..."
    python -m uvicorn $APP --host $HOST --port $PORT $RELOAD && break
done

